using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using Fuzzware.Fuzzsaw.Common.ViewModel;
using Fuzzware.Schemas.AutoGenerated;

namespace Fuzzware.Fuzzsaw.Output.ViewModel
{
    public class OutputFileStoreViewModel : OutputBaseViewModel, IOutputHandler
    {
        #region Dependency Properties

        static readonly DependencyProperty FileStoreViewModelProperty = DependencyProperty.Register("FileStoreViewModel", typeof(FileStoreControlViewModel), typeof(OutputFileStoreViewModel));
        public FileStoreControlViewModel FileStoreViewModel
        {
            get { return (FileStoreControlViewModel)GetValue(FileStoreViewModelProperty); }
            set { SetValue(FileStoreViewModelProperty, value); }
        }
        #endregion

        public OutputFileStoreViewModel()
        {
            FileStoreViewModel = new FileStoreControlViewModel();
            FileStoreViewModel.DirectoryName = Fuzzsaw.DefaultOutputDir;
            FileStoreViewModel.FileExtension = Fuzzsaw.DefaultOutputExt;
        }

        #region IOutputHandler Members

        public Type GetDataOutputHandlerItemType()
        {
            return typeof(FileStore);
        }

        public EvaluationMethod EvaluationMethod
        {
            get
            {
                if (null == FileStoreViewModel)
                    FileStoreViewModel = new FileStoreControlViewModel();

                m_oEvaluationMethod.Item = FileStoreViewModel.GetFileStore();
                return m_oEvaluationMethod;
            }
            set
            {
                if (!(value.Item is FileStore))
                    return;

                if (null == FileStoreViewModel)
                    FileStoreViewModel = new FileStoreControlViewModel();

                m_oEvaluationMethod = value;
                FileStoreViewModel.SetFileStore(m_oEvaluationMethod.Item as FileStore);
            }
        }

        #endregion
    }
}
