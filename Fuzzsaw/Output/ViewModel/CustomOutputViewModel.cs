using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using Fuzzware.Fuzzsaw;
using Fuzzware.Schemas.AutoGenerated;
using Fuzzware.Fuzzsaw.Common.ViewModel;

namespace Fuzzware.Fuzzsaw.Output.ViewModel
{
    public class CustomOutputViewModel : OutputBaseViewModel, IOutputHandler
    {
        #region Dependency Properties

        static readonly DependencyProperty OutputViewModelProperty = DependencyProperty.Register("OutputViewModel", typeof(UserDefinedCodeControlViewModel), typeof(CustomOutputViewModel));
        public UserDefinedCodeControlViewModel OutputViewModel
        {
            get { return (UserDefinedCodeControlViewModel)GetValue(OutputViewModelProperty); }
            set { SetValue(OutputViewModelProperty, value); }
        }

        #endregion

        public CustomOutputViewModel()
        {
            OutputViewModel = new UserDefinedCodeControlViewModel();
        }

        #region IOutputHandler Members

        public Type GetDataOutputHandlerItemType()
        {
            return typeof(Fuzzware.Schemas.AutoGenerated.UserDefinedCode);
        }

        public EvaluationMethod EvaluationMethod
        {
            get
            {
                if (null == OutputViewModel)
                    OutputViewModel = new UserDefinedCodeControlViewModel();

                m_oEvaluationMethod.Item = OutputViewModel.GetUserDefinedCode();

                return m_oEvaluationMethod;
            }
            set
            {
                if (!(value.Item is Fuzzware.Schemas.AutoGenerated.UserDefinedCode))
                    return;

                if (null == OutputViewModel)
                    OutputViewModel = new UserDefinedCodeControlViewModel();

                m_oEvaluationMethod = value;
                OutputViewModel = new UserDefinedCodeControlViewModel((Fuzzware.Schemas.AutoGenerated.UserDefinedCode)m_oEvaluationMethod.Item);
            }
        }

        #endregion
    }
}
