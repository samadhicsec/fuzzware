using System;
using System.Collections.Generic;
using System.Text;
using System.Diagnostics;
using Fuzzware.Schemas.AutoGenerated;

namespace Fuzzware.Monitoring.FuzzwareDBG
{
    public class FuzzwareDBGProxy : Process
    {
        FuzzwareDBGConfig oFDBGConfig;
        IFuzzwareDBG oIFuzzwareDBG;

        uint PID;

        public FuzzwareDBGProxy(FuzzwareDBGConfig FDBGConfig)
        {
            oFDBGConfig = FDBGConfig;

            FuzzwareDBG oFuzzwareDBG = new FuzzwareDBG();
            oIFuzzwareDBG = (IFuzzwareDBG)oFuzzwareDBG;
        }

        //public string ExecuteCommand(string Command)
        //{
        //    string response;
        //    oIFuzzwareDBG.ExecuteCommand(Command, out response);
        //    return response;
        //}

        public new bool Start()
        {
            return true;
        }

        public uint CreateProcess(string ExeFilePath, string CommandLine)
        {
            string ProcessStr = ExeFilePath + " " + CommandLine;

            oIFuzzwareDBG.SetOutputDir(oFDBGConfig.CrashOutputDir);

            oIFuzzwareDBG.CreateProcess(ProcessStr);

            PID = oIFuzzwareDBG.RunProcess();

            return PID;
        }

        public void End()
        {
            oIFuzzwareDBG = null;
        }
    }
}
